<div class="modal-overlay" (click)="cancelar()">
  <div class="modal-box" (click)="$event.stopPropagation()">

    <div class="header">
      <h2>{{ isEditando ? 'Editar dispositivo' : 'Cadastro de dispositivo' }}</h2>
      <span class="fechar" (click)="cancelar()">X Fechar</span>
    </div>

    <form [formGroup]="form" class="form-grid">

      <div class="col-esq">
        <label>Nome: <span class="obrigatorio">*</span></label>
        <input type="text" formControlName="nomeDispositivo" />
        <div class="erro-validacao" *ngIf="form.get('nomeDispositivo')?.invalid && form.get('nomeDispositivo')?.touched">
          Nome √© obrigat√≥rio
        </div>

        <label>Categoria <span class="obrigatorio">*</span></label>
        <div class="categoria-grid">
          <div
            *ngFor="let c of categorias"
            class="categoria-item"
            [class.selected]="form.value.categoria == c.id"
            (click)="selecionarCategoria(c.id)"
          >
            <div class="icon">{{ c.icon }}</div>
            <span>{{ c.nome }}</span>
          </div>
        </div>
        <div class="erro-validacao" *ngIf="form.get('categoria')?.invalid && form.get('categoria')?.touched">
          Categoria √© obrigat√≥ria
        </div>

        <label>Data de aquisi√ß√£o: <span class="obrigatorio">*</span></label>
        <input type="date" formControlName="dataAquisicao">
        <div class="erro-validacao" *ngIf="form.get('dataAquisicao')?.invalid && form.get('dataAquisicao')?.touched">
          Data de aquisi√ß√£o √© obrigat√≥ria
        </div>

        <label>Observa√ß√µes: <span class="obrigatorio">*</span></label>
        <textarea formControlName="observacoes"></textarea>
        <div class="erro-validacao" *ngIf="form.get('observacoes')?.invalid && form.get('observacoes')?.touched">
          Observa√ß√µes s√£o obrigat√≥rias
        </div>
      </div>

      <div class="col-dir">
        <div *ngIf="!isEditando" class="box-section">
          <div class="box-header">
            <span>üîß Primeira Manuten√ß√£o <span class="obrigatorio">*</span></span>
          </div>

          <label>Data da Manuten√ß√£o:</label>
          <input type="date" formControlName="dataManutencao" class="manutencao-input">
          <div class="erro-validacao" *ngIf="form.get('dataManutencao')?.invalid && form.get('dataManutencao')?.touched">
            Data da manuten√ß√£o √© obrigat√≥ria
          </div>

          <label>Descri√ß√£o da Manuten√ß√£o:</label>
          <textarea
            formControlName="descricaoManutencao"
            class="descricao-manutencao"
            placeholder="Descreva o que foi feito na primeira manuten√ß√£o..."
          ></textarea>
          <div class="erro-validacao" *ngIf="form.get('descricaoManutencao')?.invalid && form.get('descricaoManutencao')?.touched">
            Descri√ß√£o da manuten√ß√£o √© obrigat√≥ria
          </div>
        </div>

        <div *ngIf="isEditando" class="box-section" style="background: #fff3cd; border: 1px solid #ffeaa7;">
          <div class="box-header">
            <span>üîß Gerenciamento de Manuten√ß√µes</span>
          </div>
          <div style="color: #856404; font-size: 0.9rem; line-height: 1.4;">
            <p style="margin: 0;">
              Para adicionar, editar ou excluir manuten√ß√µes, acesse os detalhes do dispositivo.
              L√° voc√™ poder√° gerenciar todo o hist√≥rico de manuten√ß√µes.
            </p>
          </div>
        </div>

        <br>

        <div class="box-section">
          <div class="box-header">
            <span>üîî Lembretes <span class="obrigatorio">*</span></span>
          </div>
          <textarea class="lembrete-textarea" formControlName="lembrete"></textarea>
          <div class="erro-validacao" *ngIf="form.get('lembrete')?.invalid && form.get('lembrete')?.touched">
            Lembrete √© obrigat√≥rio
          </div>
        </div>

      </div>

    </form>

    <div class="botoes">
      <button class="btn-salvar" type="button" (click)="salvar()" [disabled]="form.invalid">
        {{ isEditando ? 'Atualizar' : 'Salvar' }}
      </button>
    </div>

  </div>
</div>
